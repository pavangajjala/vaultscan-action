name: VaultScan GitHub Action (Python)
description: Run VaultScan via Python for secret detection

runs:
  using: composite
  steps:
    - name: Clone VaultScan
      run: |
        git clone https://github.com/pavangajjala/vaultscan-community.git
      shell: bash

    - name: Install VaultScan dependencies
      run: |
        pip install -r vaultscan-community/requirements.txt
      shell: bash

    - name: Run VaultScan
      run: |
        python -m vaultscan.main --path . --verbose
      working-directory: vaultscan-community
      shell: bash